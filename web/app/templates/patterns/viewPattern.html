{% extends "base.html" %}

{% set logged = True %}
{% set therapistName = therapistLiteral %}

{% from 'macros.html' import titleMacro with context %}
{% from 'macros.html' import groupsTableMacro with context %}
{% from 'macros.html' import patientsTableMacro with context %}
{% from 'macros.html' import breadCrumbMacro with context %}

{% block head %}

    {% assets "accordionMultiselectCss" %}
        <link rel="stylesheet" href="{{ ASSET_URL }}" type="text/css" />
    {% endassets %}

    {% assets "accordionMultiselectJs" %}
        <script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}

    <script type="text/javascript" charset="utf-8">
    	$(document).ready(function() {
    		$(function () {
            	$('#paginationSelect').multipleSelect();
            	$('#paginationSelect2').multipleSelect();
    		})
    	});
    </script>

    <!-- SocketIO methods -->
    <script>

        function paginationFunc(){
            console.log("[DEBUG] TODO.");
        }

        function paginationFunc2(){
        	console.log("[DEBUG] TODO.");
        }

        function linkPatient(){
            location.href = "{{ url_for('patterns.linkPatientsPattern', idPattern=123456) }}".replace(123456, "{{patternInfo.id}}");
        }

        function unlinkPatient(patiId){
            location.href = "{{ url_for('patterns.viewPattern', idPattern=123456) }}?unlinkPati=".replace(123456, "{{patternInfo.id}}") + patiId;
        }

        function linkGroup(){            //TODO:check
            location.href = "{{ url_for('patterns.linkGroupsPattern', idPattern=123456) }}".replace(123456, "{{patternInfo.id}}");
        }

        function unlinkGroup(groupId){
            //location.href = location.protocol + '//' + location.host + "/verPauta/"+{{idPattern}} + "?unlinkGroup=" + groupId;
            //TODO:check
            location.href = "{{ url_for('patterns.viewPattern', idPattern=123456) }}?unlinkGroup=".replace(123456, "{{patternInfo.id}}") + groupId;
        }

        function modifyPattern(){
            location.href = "{{ url_for('patterns.editPattern', idPattern=123456) }}".replace(123456, "{{patternInfo.id}}");
        }
    </script>

{% endblock %}

{% block content %}	

{{ breadCrumbMacro(rowsBreadCrumb, patternInfo.name) }}

{{ titleMacro("Ver una pauta") }}

<!-- Input data -->

<div class="columns is-vcentered is-centered">

	<div class="column is-8 box" align="center">

		<div align="center">
			<h4 class="title is-4">Datos de la pauta</h4>

			<b> Nombre</b>:&nbsp;&nbsp; {{ patternInfo.name }}
			<br><br>
			<b> Descripción </b>:&nbsp;&nbsp; {{ patternInfo.description }}
			
			<br><br>
            
			<b>Intensidad amarilla</b>:&nbsp;&nbsp;&nbsp;&nbsp;

			{% if patternInfo.intensity1=="No" %}
                No&nbsp;&nbsp;<span style='color:red;'><i class='fas fa-times'></i></span>
            {% else %}
                Sí&nbsp;&nbsp;<span style='color:green;'><i class='fas fa-check'></i></span>
            {% endif %}
			
			<br><br>
            
			<b>Intensidad naranja</b>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

			{% if patternInfo.intensity2=="No" %}
                No&nbsp;&nbsp;<span style='color:red;'><i class='fas fa-times'></i></span>
            {% else %}
                Sí&nbsp;&nbsp;<span style='color:green;'><i class='fas fa-check'></i></span>
            {% endif %}

			<br><br>
            
			<b>Intensidad roja</b>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

			{% if patternInfo.intensity3=="No" %}
                No&nbsp;&nbsp;<span style='color:red;'><i class='fas fa-times'></i></span>
            {% else %}
                Sí&nbsp;&nbsp;<span style='color:green;'><i class='fas fa-check'></i></span>
            {% endif %}

            <br><br>

            <a onclick="modifyPattern()"><input class="button is-primary" type="button" value="Modificar" ></a>

		</div>

		<br><div style='max-width:400px'><hr></div><br>

        <div class="box" style='max-width:1000px'>
            <h4 class="title is-4 is-spaced">Pacientes que incluyen esta pauta</h4>
            {% if rowsPatients|length > 0 %}
            	{{ patientsTableMacro(rowsPatients, 2) }}
            {% endif %}

            Número de registros totales: <b>{{ numberRowsPatient }}</b>

        	{% if pagesPatients > 1 %}
                <br>
        		{{ form2.pagination.label }} &nbsp;&nbsp; {{ form2.pagination }}
                <br>
    		{% endif %}

            <br><br>

            <input class="button is-info" id="linkPatternBtn" name="linkPatternBtn" onclick="javascript:linkPatient()" type="button" value="Enlazar a un nuevo paciente">
        </div>
        
        <div style='max-width:400px'><hr></div>

        <div class="box" style='max-width:1000px'>
            <h4 class="title is-4 is-spaced">Grupos de pautas que incluyen esta pauta</h4>



        	<div id="tablearea" align="center" class="box">
        	{% if rowsGroups|length > 0 %}
    	    	{{ groupsTableMacro(rowsGroups, 2) }}
        	{% endif %}
        	
        	Número de registros totales: <b>{{ numberRowsGroup }}</b>
        	
        	{% if pagesGroups > 1 %}
                <br>
        		{{ form.pagination.label }} &nbsp;&nbsp; {{ form.pagination }}
        	{% endif %}

            <br><br>

            <input class="button is-info" id="linkGroupBtn" name="linkGroupBtn" onclick="javascript:linkGroup()" type="button" value="Enlazar a un nuevo grupo">
        </div>
    </div>
</div>

{% endblock %}
